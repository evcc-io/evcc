template: volvo-connected
products:
  - brand: Volvo
requirements:
  evcc: ["skiptest"]
  description:
    de: |
      Für die Nutzung mit evcc benötigst du einen Volvo Account und einen Volvo Connected Car API Key. 
      1. Erstelle dazu auf der [Account Seite](https://developer.volvocars.com/account/) eine neue Applikation und speichere den primären VCC API Key ab. 
      2. Veröffentliche nun deine Applikation und wähle unter **Scopes** folgende Berechtigungen **Connected Vehicle API:** `conve:vehicle-relation, conve:odometer-status`, **Energy API:** `energy:state:read`
      3. Als Redirect URL musst du die URL deiner evcc Instanz eintragen, zb `https://evcc.example.org/providerauth/callback`.
      4. Beim Anlegen des Fahrzeugs über die UI wird ein Fehler angezeigt.
      5. Öffne einen neuen Tab und gehe auf die evcc Konfigurationsseite. Im Menü oben rechts wird ein Knopf zum Anmelden angezeigt.
      6. Melde dich mit deinem Volvo Account an und erlaube den Zugriff auf die Daten. Ist die Autorisierung erfolgreich, kann das Fahrzeug hinzugefügt werden.

      **HINWEIS:** Volvo erfordert erneutes Login alle 7 Tage. Falls Fahrzeug nicht mehr eingeloggt, Logout/Login im Menü nutzen.
    en: |
      To use with evcc, you need a Volvo account and a Volvo Connected Car API Key.
      1. To do this, create a new application on the [Account page](https://developer.volvocars.com/account/) and save the primary VCC API key.
      2. Now publish your application and select the **Scope** permissions **Connected Vehicle API:** `conve:vehicle-relation, conve:odometer-status`, **Energy API:** `energy:state:read`.
      3. You must enter the URL of your evcc instance as the redirect URL, e.g. `https://evcc.example.org/providerauth/callback`.
      4. When adding the vehicle via the UI, an error message is displayed.
      5. Open a new tab and go to the evcc configuration page. A button for logging in will appear in the top right menu.
      6. Log in with your Volvo account and allow access to the data. If the authorization is successful, the vehicle can be added.

      **NOTE:** Volvo enforces re-login every 7 days. Use "hamburger" menu logout/login.
params:
  - preset: vehicle-common
  - name: vccapikey
    required: true
    description:
      generic: VCC API Key
    help:
      en: "from [Volvo Developer App](https://developer.volvocars.com/)."
      de: "aus [Volvo Developer App](https://developer.volvocars.com/)."
  - name: clientId
    required: true
    help:
      en: "from [Volvo Developer App](https://developer.volvocars.com/)."
      de: "aus [Volvo Developer App](https://developer.volvocars.com/)."
  - name: clientSecret
    required: true
    help:
      en: "from [Volvo Developer App](https://developer.volvocars.com/)."
      de: "aus [Volvo Developer App](https://developer.volvocars.com/)."
  - name: redirectUri
    required: true
    description:
      generic: Redirect URI
    help:
      en: "Redirect URI of your evcc instance. Must match the redirect URI set in your Volvo Developer App."
      de: "Redirect-URI deiner evcc-Instanz. Muss mit der Redirect-URI übereinstimmen, die in deiner Volvo Developer App festgelegt ist."
    service: auth/redirecturi
    example: "https://evcc.example.org/providerauth/callback"
  - name: vin
    example: WF0FXX...
    required: true
  - name: accessToken
    deprecated: true
  - name: refreshToken
    deprecated: true
auth:
  type: volvo-connected
  params: [clientId, clientSecret, redirectUri]
render: |
  type: volvo-connected
  vccapikey: {{ .vccapikey }}
  credentials:
    id: {{ .clientId }}
    secret: {{ .clientSecret }}
  redirecturi: {{ .redirectUri }}
  vin: {{ .vin }}
  {{ include "vehicle-common" . }}
