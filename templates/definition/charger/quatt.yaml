template: quatt
products:
  - brand: Quatt
    description:
      generic: Hybrid Heatpump
group: heating
requirements:
  # evcc: ["sponsorship"]
  evcc: ["skiptest"]
  description:
    en: |
      Integration for Quatt hybrid heat pumps using the local network API.
      No authentication is required. The device reports its current status over HTTP in JSON format.
    de: |
      Integration für Quatt-Hybrid-Wärmepumpen über die lokale Netzwerkschnittstelle.
      Keine Authentifizierung erforderlich – das Gerät stellt Statusdaten im JSON-Format per HTTP bereit.
params:
  - name: host
    required: true
    default: REQUIRED
    description:
      en: IP or hostname
      de: IP-Adresse oder Hostname
    help:
      en: IP address or hostname of the Quatt controller in your local network.
      de: IP-Adresse oder Hostname des Quatt-Controllers im lokalen Netzwerk.  - name: host
    required: true
    default: REQUIRED
    description:
      en: IP or hostname
      de: IP-Adresse oder Hostname
    help:
      en: IP address or hostname of the Quatt controller in your local network.
      de: IP-Adresse oder Hostname des Quatt-Controllers im lokalen Netzwerk.
  - name: port
    required: false
    default: 8080
    description:
      en: API port
      de: API-Port
    help:
      en: Port used by the local Quatt API (default is 8080).
      de: Port der lokalen Quatt-API (Standard ist 8080).
render: |
  type: sgready
  getmode:
    source: http
    uri: http://{{ .host }}:{{ .port }}/beta/feed/data.json
    cache: 2s
    jq: |
      .boiler.otFbChModeActive as $ch
      | .boiler.otFbDhwActive as $dhw
      | if $ch == true or $dhw == true then 2 else 1 end
  temp:
    source: http
    uri: http://{{ .host }}:{{ .port }}/beta/feed/data.json
    cache: 5s
    jq: .hp1.temperatureWaterOut
  limittemp:
    source: http
    uri: http://{{ .host }}:{{ .port }}/beta/feed/data.json
    cache: 5s
    jq: .thermostat.otFtRoomSetpoint
  power:
    source: http
    uri: http://{{ .host }}:{{ .port }}/beta/feed/data.json
    cache: 5s
    jq: .hp1.powerInput
    scale: 1
