template: eastron
products:
  - brand: Eastron
    description:
      generic: SDM630-Modbus
  - brand: Eastron
    description:
      generic: SDM72DM-V2
  - brand: Weidmüller
    description:
      generic: EM120-RTU-2P
  - brand: Weidmüller
    description:
      generic: EM122-RTU-2P
  - brand: Kostal
    description:
      generic: Energy Meter P (KEM-P)
params:
  - name: usage
    choice: ["grid", "pv", "charge"]
  - name: modbus
    choice: ["rs485"]
render: |
  type: mbmd
  {{- include "modbus" . }}
  model: sdm
  {{- if ne .usage "pv" }}
  power: Power
  energy: Import
  currents:
    - CurrentL1
    - CurrentL2
    - CurrentL3
  powers:
    - PowerL1
    - PowerL2
    - PowerL3
  {{- else }}
  power: -Power
  energy: Export
  currents:
    - -CurrentL1
    - -CurrentL2
    - -CurrentL3
  powers:
    - -PowerL1
    - -PowerL2
    - -PowerL3
  {{- end }}
  voltages:
    - VoltageL1
    - VoltageL2
    - VoltageL3
