template: sessy-p1
products:
  - brand: Sessy
    description:
      generic: Sessy P1
params:
  - name: usage
    choice: ["grid"]
  - name: host
    required: true
  - name: cache
    advanced: true
    default: 60
render: |
  type: custom
  power:
    source: http
    uri: http://{{ .host }}/api/v2/p1/details
    method: GET
    headers:
      - content-type: application/json
    insecure: false
    jq: .power_total
    cache: {{ .cache }}
    timeout: 10s
  energy:
    source: calc
    add:
      - source: http
        uri: http://{{ .host }}/api/v2/p1/details
        method: GET
        headers:
          - content-type: application/json
        insecure: false
        jq: .power_consumed_tariff1
        scale: 0.001
        cache: {{ .cache }}
        timeout: 10s
      - source: http
        uri: http://{{ .host }}/api/v2/p1/details
        method: GET
        headers:
          - content-type: application/json
        insecure: false
        jq: .power_consumed_tariff2
        scale: 0.001
        cache: {{ .cache }}
        timeout: 10s
      - source: http
        uri: http://{{ .host }}/api/v2/p1/details
        method: GET
        headers:
          - content-type: application/json
        insecure: false
        jq: .power_produced_tariff1
        scale: -0.001
        cache: {{ .cache }}
        timeout: 10s
      - source: http
        uri: http://{{ .host }}/api/v2/p1/details
        method: GET
        headers:
          - content-type: application/json
        insecure: false
        jq: .power_produced_tariff2
        scale: -0.001
        cache: {{ .cache }}
        timeout: 10s
  currents:
    - source: http
      uri: http://{{ .host }}/api/v2/p1/details
      method: GET
      headers:
        - content-type: application/json
      insecure: false
      jq: .current_l1
      scale: 0.001
      cache: {{ .cache }}
      timeout: 10s
    - source: http
      uri: http://{{ .host }}/api/v2/p1/details
      method: GET
      headers:
        - content-type: application/json
      insecure: false
      jq: .current_l2
      scale: 0.001
      cache: {{ .cache }}
      timeout: 10s
    - source: http
      uri: http://{{ .host }}/api/v2/p1/details
      method: GET
      headers:
        - content-type: application/json
      insecure: false
      jq: .current_l3
      scale: 0.001
      cache: {{ .cache }}
      timeout: 10s
  voltages:
    - source: http
      uri: http://{{ .host }}/api/v2/p1/details
      method: GET
      headers:
        - content-type: application/json
      insecure: false
      jq: .voltage_l1
      scale: 0.001
      cache: {{ .cache }}
      timeout: 10s
    - source: http
      uri: http://{{ .host }}/api/v2/p1/details
      method: GET
      headers:
        - content-type: application/json
      insecure: false
      jq: .voltage_l2
      scale: 0.001
      cache: {{ .cache }}
      timeout: 10s
    - source: http
      uri: http://{{ .host }}/api/v2/p1/details
      method: GET
      headers:
        - content-type: application/json
      insecure: false
      jq: .voltage_l3
      scale: 0.001
      cache: {{ .cache }}
      timeout: 10s
