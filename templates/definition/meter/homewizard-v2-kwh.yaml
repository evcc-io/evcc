template: homewizard-v2-kwh
products:
  - brand: HomeWizard
    description:
      generic: kWh Meter (v2)
      de: kWh-Zähler (v2)
requirements:
  description:
    en: |
      kWh Meter for PV monitoring using WebSocket API v2.

      **Setup:** Run `evcc token homewizard` to discover and pair devices
    de: |
      kWh-Zähler für PV-Messung mit WebSocket API v2.

      **Einrichtung:** Führen Sie `evcc token homewizard` aus
params:
  - name: host
    description:
      en: Device hostname or IP
      de: Gerätehostname oder IP
    required: true
  - name: token
    description:
      en: Device authentication token
      de: Geräte-Authentifizierungstoken
    required: true
    mask: true
  - name: phases
    choice: [1, 3]
    description:
      en: Number of phases
      de: Anzahl der Phasen
    help:
      en: |
        1: Single-phase meter (HWE-KWH1)
        3: Three-phase meter (HWE-KWH3)
      de: |
        1: Einphasiger Zähler (HWE-KWH1)
        3: Dreiphasiger Zähler (HWE-KWH3)
    default: 3
  - name: usage
    choice: ["pv", "charge"]
    description:
      en: Meter usage type
      de: Zählerverwendungstyp
    help:
      en: |
        pv: Solar production (inverts power, production shows as positive)
        grid: Grid monitoring (no inversion, import = positive, export = negative)
        charge: Charge monitoring
      de: |
        pv: Solarproduktion (invertiert Leistung, Produktion zeigt positiv)
        grid: Netzmessung (keine Invertierung, Import = positiv, Export = negativ)
        charge: Lademessung
    default: pv
  - name: timeout
    description:
      en: Connection timeout
      de: Verbindungs-Timeout
    advanced: true
    default: 30s
render: |
  type: homewizard-v2
  host: {{ .host }}
  token: {{ .token }}
  phases: {{ .phases }}
  usage: {{ .usage }}
  {{- if .timeout }}
  timeout: {{ .timeout }}
  {{- end }}
