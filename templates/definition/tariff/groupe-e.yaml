template: groupe-e
products:
  - brand: Groupe E
    description:
      generic: Vario Plus
requirements:
  evcc: ["skiptest"]
group: price
countries: ["CH"]
params:
  - preset: tariff-base
render: |
  type: custom
  {{ include "tariff-base" . }}
  forecast:
    source: http
    uri: https://api.tariffs.groupe-e.ch/v2/tariffs?start_timestamp={{ `{{ now.UTC | mustDateModify "-1h" | date "2006-01-02T15" }}` }}:00:00Z&end_timestamp={{ `{{ addDate now.UTC 0 0 2 | date "2006-01-02T15" }}` }}:00:00Z
    jq: |
      [.prices[] |
        {
          start: (.start_timestamp),
          end: (.end_timestamp),
          value: (.integrated[] | select(.unit == "CHF_kWh") | .value)
        }
      ] | tostring
